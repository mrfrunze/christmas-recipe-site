# Решение проблемы с Git и .next директорией

## Проблема
- Ошибка: `Permission denied` на `.next/dev/lock`
- Предупреждения о LF/CRLF (это нормально для Windows)

## Причина
1. Next.js dev-сервер запущен и держит файл `.next/dev/lock`
2. Git пытается обработать файлы в `.next/`, даже если они в `.gitignore`

## Решение (пошагово)

### Шаг 1: Остановите Next.js dev-сервер

**Если у вас запущен `npm run dev` или `next dev`:**
1. Найдите окно терминала, где запущен dev-сервер
2. Нажмите `Ctrl + C` чтобы остановить сервер
3. Или закройте окно терминала

**Если не знаете, запущен ли сервер:**
- Откройте Task Manager (Диспетчер задач)
- Найдите процессы `node.exe`
- Закройте их (если это dev-сервер)

### Шаг 2: Удалите файл блокировки (если нужно)

В PowerShell выполните:
```powershell
cd g:\Frontend\GitHub-Frontend\christmas-recipe-site
Remove-Item -Path ".next\dev\lock" -Force -ErrorAction SilentlyContinue
```

### Шаг 3: Убедитесь, что .next в .gitignore

Проверьте, что в `.gitignore` есть строка:
```
.next/
```

Если нет - добавьте её.

### Шаг 4: Удалите .next из Git (если он уже отслеживается)

**В GitHub Desktop:**
1. Откройте раздел **Changes**
2. Если видите файлы из `.next/` - НЕ добавляйте их
3. Если они уже добавлены - удалите их из staging area

**Или через командную строку:**
```bash
git rm -r --cached .next
```

### Шаг 5: Очистите рабочую директорию

**Вариант 1: Удалите .next директорию (рекомендуется)**
```powershell
Remove-Item -Path ".next" -Recurse -Force -ErrorAction SilentlyContinue
```

`.next` будет автоматически пересоздан при следующем запуске `npm run dev`

**Вариант 2: Оставьте .next, но убедитесь, что он в .gitignore**
- Файлы в `.next/` должны игнорироваться Git
- Проверьте, что они не появляются в разделе Changes в GitHub Desktop

### Шаг 6: Проверьте состояние

В GitHub Desktop:
1. Раздел **Changes** должен быть пустым (или не содержать файлы из `.next/`)
2. Файлы из `.next/` не должны быть видны

### Шаг 7: Закоммитьте изменения (если нужно)

Если у вас есть другие изменения (не из `.next/`):
1. Проверьте раздел **Changes**
2. Убедитесь, что там НЕТ файлов из `.next/`
3. Закоммитьте только нужные файлы
4. Нажмите **Commit**

## Как вернуть всё назад (Undo)

Если вы хотите отменить все изменения:

### Вариант 1: Отменить все незакоммиченные изменения
```bash
git restore .
```

Или в GitHub Desktop:
1. **Repository → Discard All Changes...**
2. Подтвердите

### Вариант 2: Отменить конкретные файлы
```bash
git restore <file>
```

### Вариант 3: Отменить последний commit (если ещё не запушен)
```bash
git reset --soft HEAD~1
```

## Предотвращение проблемы в будущем

1. **Всегда останавливайте dev-сервер перед коммитом**
   - Нажмите `Ctrl + C` в терминале с `npm run dev`

2. **Убедитесь, что .next в .gitignore**
   - Файл `.gitignore` должен содержать `.next/`

3. **Не добавляйте .next в Git**
   - В GitHub Desktop не добавляйте файлы из `.next/` в Changes

4. **Используйте .env.local для переменных окружения**
   - Добавьте `.env.local` в `.gitignore`

## Проверка после исправления

После выполнения всех шагов:
1. ✅ Dev-сервер остановлен
2. ✅ `.next/` в `.gitignore`
3. ✅ Файлы из `.next/` не видны в Changes
4. ✅ Можно делать commit и push без ошибок

## Если проблема осталась

1. Закройте GitHub Desktop
2. Закройте все терминалы с Node.js процессами
3. Перезапустите GitHub Desktop
4. Попробуйте снова

